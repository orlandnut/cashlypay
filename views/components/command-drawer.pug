mixin commandDrawer(opts)
  - const options = opts || {};
  - const links = Array.isArray(options.links) ? options.links : [];
  - const actions = Array.isArray(options.actions) ? options.actions : [];
  - const currentPath = options.currentPath || "";
  -
    const defaultLinks = links.length
      ? links
      : [
          { label: "Dashboard", href: "/", match: "/" },
          { label: "Customer Hub", href: "/customers", match: ["/customers", "/management"] },
          { label: "Services", href: "/catalog", match: "/catalog" },
          { label: "Gift Cards", href: "/gift-cards", match: "/gift-cards" },
          { label: "Analytics", href: "/analytics", match: "/analytics" },
          { label: "Reminder Queue", href: "/admin/reminders", match: "/admin" },
          { label: "Payouts", href: "/payouts/console", match: "/payouts" }
        ];
  -
    const defaultActions = actions.length
      ? actions
      : [
          { label: "Create Invoice", href: "/invoice/create", tone: "primary" },
          { label: "Run Reminder Queue", href: "/admin/reminders", tone: "ghost" }
        ];

  .command-drawer(id="commandDrawer" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Navigation drawer")
    .command-drawer__panel
      .command-drawer__header
        .command-drawer__brand
          a.command-drawer__brand-lockup(href="/")
            span.sr-only CashlyPay home
            .logo-mark
              img(src="/images/cashly-logo.png" alt="CashlyPay mark" width="48" height="48" loading="lazy" decoding="async")
            .drawer-meta
              span.drawer-title CashlyPay OS
              img.drawer-meta__wordmark(src="/images/cashly-full-logo.png" alt="CashlyPay logotype" width="160" height="36" loading="lazy" decoding="async")
              span.drawer-subtitle Navigate & automate
              span.drawer-meta__tagline Finance OS
        button.command-drawer__close(type="button" aria-label="Close navigation panel")
          span
      nav.command-drawer__nav
        ul
          each link in defaultLinks
            -
              const matchTarget = link.match || link.href;
              const matches = Array.isArray(matchTarget) ? matchTarget : [matchTarget];
              const isActive = matches.some((target) =>
                target ? currentPath === target || currentPath.startsWith(target) : false
              );
            li
              a(class=isActive ? 'active' : '' href=link.href)= link.label
      if defaultActions.length
        .command-drawer__actions
          each action in defaultActions
            - const tone = action.tone || "primary";
            - let btnClass = "button button-primary";
            - if (tone === "secondary") btnClass = "button button-secondary";
            - else if (tone === "ghost") btnClass = "button button-ghost";
            a(class=btnClass href=action.href)= action.label
