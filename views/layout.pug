//- Copyright 2020 Square Inc.
 
//- Licensed under the Apache License, Version 2.0 (the "License");
//- you may not use this file except in compliance with the License.
//- You may obtain a copy of the License at
 
//-     http://www.apache.org/licenses/LICENSE-2.0
 
//- Unless required by applicable law or agreed to in writing, software
//- distributed under the License is distributed on an "AS IS" BASIS,
//- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//- See the License for the specific language governing permissions and
//- limitations under the License. 

doctype html
html(lang="en" class="dark")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover")
    meta(name="theme-color" content="#00D54B")
    meta(name="description" content="Modern invoice management with Cash App style")
    meta(name="mobile-web-app-capable" content="yes")
    meta(name="apple-mobile-web-app-capable" content="yes")
    meta(name="apple-mobile-web-app-status-bar-style" content="black-translucent")
    meta(name="format-detection" content="telephone=no")
    
    //- Favicon
    link(rel="icon" type="image/png" sizes="32x32" href="/images/cashly-logo.png")
    link(rel="apple-touch-icon" href="/images/cashly-logo.png")
    
    //- Main Stylesheet
    link(rel="stylesheet" href="/stylesheets/main.css")
    //- Shared dark theme (payout) styles
    link(rel="stylesheet" href="/stylesheets/pages/dark-theme.css")
    block styles
    
    title Cashly - Modern Invoice Management
    
    //- Scripts
    block scripts
      script(defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js")
    script(defer src="/javascripts/dashboard.js")
  
  body.dark
    a.skip-link(href="#dashboardMain") Skip to dashboard
    #sr-announcer.sr-only(aria-live="assertive" aria-atomic="true")
    #toast-stack.toast-stack
    include ../public/images/sprites.svg
    include components/dark-hero.pug
    include components/command-drawer.pug

    //- Sidebar
    aside.sidebar
      - const sidebarEnv = envStatus && typeof envStatus === 'object' ? envStatus : null;
      - const sidebarEnvTone = sidebarEnv && sidebarEnv.tone ? sidebarEnv.tone : (sidebarEnv && sidebarEnv.label && sidebarEnv.label.toLowerCase().includes('live') ? 'live' : 'sandbox');
      .sidebar__header
        .sidebar__branding
          a.brand-lockup(href="/")
            span.sr-only CashlyPay home
            .logo-mark
              img(src="/images/cashly-logo.png" alt="CashlyPay mark" width="56" height="56" loading="lazy" decoding="async")
            .brand__text
              span.brand__eyebrow Finance OS
              .brand__wordmark.wordmark.wordmark--compact
                span.wordmark__main Cashly
                span.wordmark__accent Pay
                span.wordmark__signal
              span.brand__descriptor Command Center
          if sidebarEnv
            span.brand-lockup__env(class=`env-pill env-pill--${sidebarEnvTone === 'live' ? 'live' : 'sandbox'}`)
              span.env-pill__dot
              span.env-pill__label= sidebarEnvTone === 'live' ? 'Live mode' : 'Sandbox mode'
          else
            span.sidebar__title-command Command Center
      .sidebar__profile
        .avatar A
        .profile__meta
          span.profile__name Ops Team
          span.profile__role Admin
        a.button.button-ghost.button-sm(href="/analytics")
          svg(width="16" height="16" viewBox="0 0 24 24" fill="none")
            path(d="M4 12h16M4 6h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round")
          span Insights

      nav.nav
        .nav__section
          p.nav-section Workspace
          ul.nav__list
            li
              a.nav-item(href="/" class=currentPath === '/' ? 'active' : '')
                svg: use(href="#icon-dashboard")
                span Dashboard
            -
              const customersActive =
                currentPath &&
                (currentPath.startsWith('/customers') || currentPath.startsWith('/management'));
            li
              a.nav-item(href="/customers" class=customersActive ? 'active' : '')
                svg: use(href="#icon-invoice")
                span Customer Hub
            li
              a.nav-item(href="/catalog" class=(currentPath && currentPath.startsWith('/catalog') ? 'active' : ''))
                svg: use(href="#icon-dashboard")
                span Services
        .nav__section
          p.nav-section Revenue Ops
          ul.nav__list
            li
              a.nav-item(href="/gift-cards" class=(currentPath && currentPath.startsWith('/gift-cards') ? 'active' : ''))
                svg: use(href="#icon-invoice")
                span Gift Cards
            li
              a.nav-item(href="/analytics" class=(currentPath && currentPath.startsWith('/analytics') ? 'active' : ''))
                svg: use(href="#icon-dashboard")
                span Analytics
            li
              a.nav-item(href="/admin/reminders" class=(currentPath && currentPath.startsWith('/admin') ? 'active' : ''))
                svg: use(href="#icon-invoice")
                span Reminders
            li
              a.nav-item(href="/payouts/console" class=(currentPath && currentPath.startsWith('/payouts') ? 'active' : ''))
                svg: use(href="#icon-dashboard")
                span Payouts
        .nav__section.nav__section--actions
          p.nav-section Quick Action
          a.nav-item.nav-item--cta(href="/customers/new")
            svg: use(href="#icon-dashboard")
            span Add Customer
    
    .sidebar-overlay
    //- Main Content
    main.content
      .container#dashboardMain
        .money-dashboard
          block hero
          block content

    .help-overlay(data-help-overlay aria-hidden="true")
      .help-overlay__backdrop
      .help-overlay__card(role="dialog" aria-modal="true" aria-label="Quick tour")
        span.help-overlay__eyebrow Quick tour
        h3.help-overlay__title Master your workspace
        ul.help-overlay__list
          li Pin filters and quick actions in the toolbar while you scroll.
          li Use quick actions to spin up invoices, estimates, or payouts fast.
          li Watch status chips and toasts for live reminders and sync signals.
        .help-overlay__actions
          button.button.button-secondary.button-sm(type="button" data-help-dismiss) Got it
          button.button.button-ghost.button-sm(type="button" data-help-hide) Remind me later

    //- Footer
    footer.footer
      .container
        .flex.items-center.justify-between(class="h-[var(--footer-height)]")
          p.text-sm Â© 2025 CashlyPay. All rights reserved.
          .flex.gap-md
            a.text-sm(href="#") Terms
            a.text-sm(href="#") Privacy
            a.text-sm(href="#") Support
    block commandDrawer
      +commandDrawer({ currentPath, status: envStatus })
